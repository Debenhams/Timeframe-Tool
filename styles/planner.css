/**
 * WFM Intelligence Platform - Styles (v15.7)
 * Includes Base Layout, Components, Editors, Visualization (Daily/Weekly), and Trade Center.
*/

/* === VARIABLES & CONFIGURATION === */
:root {
  --font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  
  /* Modern Enterprise Palette (Indigo/Emerald) */
  --brand-primary: #4F46E5; /* Indigo 600 */
  --brand-primary-dark: #4338CA; /* Indigo 700 */
  --brand-accent: #059669; /* Emerald 600 */
  
  /* Neutrals (Cool Gray) */
  --color-text: #111827;
  --color-text-muted: #6B7280;
  --color-bg: #F9FAFB; 
  --color-panel-bg: #FFFFFF;
  --color-border: #E5E7EB;
  --color-hover-bg: #F3F4F6;
  
  /* Sidebar (Dark) */
  --sidebar-bg: #111827;
  --sidebar-text: #D1D5DB;
  --sidebar-text-hover: #FFFFFF;
  --sidebar-border: #1F2937;

  /* UI States */
  --color-success: #10B981;
  --color-success-bg: #ECFDF5;
  --color-danger: #EF4444;
  --color-danger-bg: #FEE2E2;
  
  /* V15.0: Exception State (Purple) */
  --color-exception: #9333EA; 

  /* Layout */
  --sidebar-width: 250px;
  --top-bar-height: 60px;
  --border-radius: 8px;
  
  /* Timeline Visualization */
  --timeline-name-col: 220px;
  --timeline-row-height: 34px;
  --timeline-bar-height: 34px; 
  --timeline-grid-color: #E5E7EB;
  --timeline-header-bg: #F3F4F6;
}

/* === BASE STYLES & LAYOUT === */
html, body {
  height: 100%;
  margin: 0;
  font-family: var(--font-family);
  font-size: 14px;
  background-color: var(--color-bg);
  color: var(--color-text);
  overflow: hidden; /* Prevent body scroll, rely on internal component scrolling */
}

*, *::before, *::after {
  box-sizing: border-box;
}

body {
  display: flex;
}

h1, h2, h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-weight: 600;
}

h2 {
    font-size: 20px;
}

/* === SIDEBAR NAVIGATION === */
.app-sidebar {
  width: var(--sidebar-width);
  background-color: var(--sidebar-bg);
  color: var(--sidebar-text);
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
  border-right: 1px solid var(--sidebar-border);
  height: 100vh;          /* ← add this */
  overflow-y: auto;       /* ← and this (enables scrolling) */
}


.sidebar-header {
    padding: 20px 24px;
    font-size: 18px;
    font-weight: 700;
    color: white;
    border-bottom: 1px solid var(--sidebar-border);
}

.tab-nav {
    display: flex;
    flex-direction: column;
    padding: 16px;
    gap: 4px;
}

.tab-link {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 500;
  color: var(--sidebar-text);
  background-color: transparent;
  border: none;
  border-radius: var(--border-radius);
  cursor: pointer;
  text-align: left;
  transition: background-color 0.15s, color 0.15s;
}

.tab-link:hover {
  background-color: rgba(255, 255, 255, 0.05);
  color: var(--sidebar-text-hover);
}

.tab-link.active {
  background-color: var(--brand-primary);
  color: white;
}

.tab-link.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.nav-separator {
    margin: 12px 16px 8px 16px;
    font-size: 12px;
    font-weight: 600;
    color: #6B7280;
    text-transform: uppercase;
}

/* === MAIN CONTENT & TOP BAR === */
.app-main-content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden; /* Important for internal scrolling */
}

.top-bar {
  height: var(--top-bar-height);
  background-color: var(--color-panel-bg);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 24px;
  flex-shrink: 0;
}

.top-bar-controls {
    display: flex;
    align-items: center;
    gap: 12px;
}

.top-bar-controls label {
    font-weight: 500;
}

.separator {
    height: 24px;
    width: 1px;
    background-color: var(--color-border);
    margin: 0 8px;
}

.ai-assistant-placeholder input {
    width: 300px;
}

/* === CONTENT AREA & TABS === */
/* V15.6.1: Improved Layout Handling */
.content-area {
  flex-grow: 1;
  overflow: hidden; /* Manage scrolling within tabs */
  display: flex;
  flex-direction: column;
}

.tab-content {
  display: none;
  padding: 24px;
  flex-grow: 1;
  overflow-y: auto; /* Default scrolling behavior for tabs */
}

.tab-content.active {
  display: block;
}

/* === CARDS & PANELS === */
.card {
    background-color: var(--color-panel-bg);
    border-radius: var(--border-radius);
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    padding: 24px;
    border: 1px solid var(--color-border);
}

/* === FORMS & INPUTS === */
.form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.form-input, .form-select, .week-picker {
  padding: 8px 12px;
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius);
  font-size: 14px;
  color: var(--color-text);
  background-color: white;
}

.form-input:focus, .form-select:focus {
    outline: none;
    border-color: var(--brand-primary);
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
}

/* === BUTTONS === */
.btn {
  padding: 10px 18px;
  border-radius: var(--border-radius);
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: background-color 0.15s;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 13px;
}

/* V15.7: Added large button style */
.btn-lg {
    padding: 12px 24px;
    font-size: 16px;
}

.btn-primary {
  background-color: var(--brand-primary);
  color: white;
}

.btn-primary:hover {
  background-color: var(--brand-primary-dark);
}

.btn-primary:disabled {
    background-color: #A5B4FC; /* Lighter indigo */
    cursor: not-allowed;
}

.btn-secondary {
    background-color: var(--color-hover-bg);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-secondary:hover {
    background-color: #E5E7EB;
}

.btn-danger {
    background-color: var(--color-danger);
    color: white;
}

.btn-danger:hover {
    background-color: #B91C1C;
}

.btn-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    border-radius: var(--border-radius);
    background-color: transparent;
    border: 1px solid transparent;
    cursor: pointer;
    color: var(--color-text-muted);
}

.btn-icon:hover {
    background-color: var(--color-hover-bg);
    color: var(--color-text);
}

.btn-icon:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    background-color: transparent;
}


/* === TABLES === */
.table-container {
    overflow-x: auto;
    margin-top: 20px;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
}

table {
  width: 100%;
  border-collapse: collapse;
  background-color: white;
}

th, td {
  padding: 12px 16px;
  text-align: left;
  border-bottom: 1px solid var(--color-border);
}

th {
  background-color: var(--color-hover-bg);
  font-weight: 600;
  font-size: 13px;
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

tr:last-child td {
    border-bottom: none;
}

/* General table row hover effect (Specific views may override this) */
tbody tr:hover {
    background-color: var(--color-hover-bg);
}

/* === EDITOR LAYOUTS === */
.editor-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.editor-buttons {
    display: flex;
    align-items: center;
    gap: 12px;
}

.helper-text {
    color: var(--color-text-muted);
    margin-top: -8px;
    margin-bottom: 16px;
}

/* Auto Save Status Indicator */
.auto-save-status {
    font-size: 13px;
    color: var(--brand-accent);
    opacity: 0;
    transition: opacity 0.3s;
}

/* === SCHEDULE VIEW (Layout) === */

/* V15.6.1: Ensures the schedule view takes the full available height */
.planner-section {
  height: 100%;
  /* Override parent tab scrolling behavior */
  overflow: hidden; 
}

.planner-layout {
  display: grid;
  grid-template-columns: 320px 1fr; /* Fixed width for controls, flexible for viewer */
  gap: 24px;
  height: 100%;
}

.planner-controls {
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow-y: auto; /* Allows tree view to scroll if it gets long */
  height: 100%;
}

/* Hierarchical Tree View */
.schedules-tree {
  flex-grow: 1;
  margin-top: 16px;
}

.schedules-tree label {
    cursor: pointer;
    display: block;
    padding: 8px 12px;
    border-radius: 6px;
}

.schedules-tree input[type="checkbox"] {
    margin-right: 8px;
}

.schedules-tree label:hover {
    background-color: var(--color-hover-bg);
}

/* Styling for the Leader nodes */
.tree-node-leader label {
    font-weight: 600;
    color: var(--brand-primary);
    background-color: #EEF2FF; /* Light indigo background */
}

/* Styling for the Advisor nodes (indented) */
.tree-node-advisor label {
    padding-left: 32px;
}


.planner-viewer {
  display: flex;
  flex-direction: column;
  overflow: hidden; /* Critical for the visualization container */
  padding: 0; /* Remove padding from the card container itself */
  height: 100%;
}

.planner-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 24px;
  border-bottom: 1px solid var(--color-border);
}

/* View Controls (Daily/Weekly Toggle) */
.planner-view-controls {
    display: flex;
    align-items: center;
    gap: 20px;
}

.planner-day-toggle {
    display: flex;
    align-items: center;
    gap: 12px;
}

.view-toggle-group {
    display: flex;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
}

.btn-toggle {
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 500;
    background-color: var(--color-panel-bg);
    color: var(--color-text-muted);
    border: none;
    cursor: pointer;
}

/* Handle rounded corners for the group */
.btn-toggle:first-child {
    border-top-left-radius: var(--border-radius);
    border-bottom-left-radius: var(--border-radius);
}
.btn-toggle:last-child {
    border-top-right-radius: var(--border-radius);
    border-bottom-right-radius: var(--border-radius);
}

.btn-toggle.active {
    background-color: var(--brand-primary);
    color: white;
}


/* === VISUALIZATION CONTAINER === */
.visualization-container {
  flex-grow: 1;
  overflow: auto; /* Allows the Gantt/Grid to scroll horizontally and vertically */
  position: relative;
}

.visualization-empty {
    padding: 40px;
    text-align: center;
    color: var(--color-text-muted);
}

/* === DAILY TIMELINE (GANTT) VIEW === */

/* The container for the timeline rows and header */
.timeline-container {
    position: relative;
    /* min-width ensures the timeline doesn't compress too much */
    min-width: 1200px; 
}

.timeline-header {
  display: grid;
  grid-template-columns: var(--timeline-name-col) 1fr;
  background-color: var(--timeline-header-bg);
  border-bottom: 1px solid var(--color-border);
  position: sticky;
  top: 0;
  z-index: 100; /* Ensures header stays above content */
}

.header-name { 
    padding: 12px 20px; 
    border-right: 1px solid var(--color-border); 
    font-weight: 600;
    /* Sticky positioning for the name column header */
    position: sticky;
    left: 0;
    background-color: var(--timeline-header-bg);
    z-index: 10;
}

/* V15.1: Refined Header Timeline Styling (Matching Example) */
.header-timeline { 
    position: relative; 
    height: 48px; 
    background-color: var(--timeline-header-bg); 
}

.time-tick {
  position: absolute;
  font-size: 12px;
  font-weight: 600; /* Bolder like the example */
  color: #4B5563; /* Darker gray */
  user-select: none;
  height: 100%;
  padding-left: 6px;
  display: flex;
  align-items: center;
  top: 0;
  /* Background behind text to prevent grid lines cutting through it */
  background-color: var(--timeline-header-bg);
  padding-right: 6px; 
}

/* V15.1: Grid Lines using pseudo-elements for better control */
.time-tick::after {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 5000px; /* Extend line far down the page (will be clipped by overflow) */
    width: 1px;
    background-color: var(--timeline-grid-color);
    z-index: -1; /* Behind the time label text */
}


/* Time Indicators (Current and Mouse) */
.current-time-indicator {
    position: absolute;
    top: 0;
    height: 100%;
    width: 2px;
    background-color: var(--color-danger);
    z-index: 50;
    display: none; /* Controlled by JS */
    pointer-events: none; /* Allow clicks through the line */
}

.mouse-time-indicator {
    position: absolute;
    top: 0;
    height: 100%;
    width: 1px;
    background-color: var(--color-text);
    z-index: 51;
    display: none; /* Controlled by JS */
    pointer-events: none;
}

.mouse-time-tooltip {
    position: absolute;
    background-color: var(--color-text);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
    z-index: 52;
    display: none; /* Controlled by JS */
    transform: translateX(-50%);
    pointer-events: none;
}


.timeline-row {
  display: grid;
  grid-template-columns: var(--timeline-name-col) 1fr;
  height: var(--timeline-row-height);
  border-bottom: 1px solid var(--color-border);
  /* V15.1: Make rows clickable for Live Editing */
  cursor: pointer; 
}

/* V15.1: Hover effect for timeline rows */
.timeline-row:hover {
    background-color: #F3F4F6 !important;
}

/* Alternating row colors */
.timeline-row:nth-child(odd) {
    background-color: #FFFFFF;
}
.timeline-row:nth-child(even) {
    background-color: #F9FAFB;
}


.timeline-name { 
    padding: 0 20px; 
    border-right: 1px solid var(--color-border); 
    display: flex; 
    align-items: center; 
    font-size: 14px;
    /* Sticky positioning for the name column body */
    position: sticky;
    left: 0;
    z-index: 10;
    background-color: inherit; /* Inherits the alternating row color */
}

.timeline-track {
    position: relative;
    height: 100%;
}

.timeline-bar {
  position: absolute;
  top: 0;
  height: var(--timeline-bar-height);
  display: flex;
  align-items: center;
  overflow: hidden;
  border-radius: 0; /* Square edges */
  border-right: 1px solid rgba(255,255,255,0.3); /* Subtle separator between segments */
}

/* Visualization Styles (Matching Screenshot Request) */
.timeline-bar.is-gap {
    background-color: #D1D5DB !important; /* Gray for breaks/lunch */
    color: #4B5563 !important;
}

.timeline-bar.is-activity {
    /* Using the Olive Green color from the screenshots provided previously */
    background-color: #808000 !important; 
    color: white !important;
}

/* V15.1: Exception Visualization (Hatched Overlay) */
/* When the parent row has 'is-exception', apply the overlay to the bars inside it */
.is-exception .timeline-bar {
    /* Apply a repeating linear gradient overlay to indicate an exception */
    background-image: repeating-linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.2),
        rgba(255, 255, 255, 0.2) 10px,
        transparent 10px,
        transparent 20px
    );
}


/* === WEEKLY VIEW === */
.weekly-grid {
    width: 100%;
}

/* Sticky headers for the weekly grid */
.weekly-grid thead th {
    position: sticky;
    top: 0;
    z-index: 10;
}

/* V15.1: Make weekly cells clickable */F
/* We apply this to the TD element itself (using class .weekly-cell applied by JS) */
.weekly-cell {
    cursor: pointer;
}

/* V15.1: Exception visualization for weekly view */
.weekly-cell.is-exception {
    /* Add a distinct border to indicate an exception */
    border: 2px solid var(--color-exception);
}


.weekly-cell-content {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    /* Padding is applied to the TD in the base table styles */
}

.weekly-shift-code {
    font-weight: 700;
    font-size: 14px;
    color: var(--brand-primary);
}

/* V15.1: Change code color if it's an exception */
.is-exception .weekly-shift-code {
    color: var(--color-exception);
}

.weekly-shift-time {
    font-size: 12px;
    color: var(--color-text-muted);
}

.weekly-rdo {
    font-size: 13px;
    color: #9CA3AF;
    font-weight: 500;
}

/* === V15.7: SHIFT TRADE CENTER === */
.trade-layout {
    display: flex;
    align-items: stretch; /* Ensure panels are equal height */
    gap: 24px;
    margin-top: 24px;
}

.trade-panel {
    flex: 1;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
    /* Use a slightly off-white background for the input panels */
    background-color: var(--color-hover-bg); 
}

.trade-swap-icon {
    color: var(--brand-primary);
    padding: 12px;
    /* Ensure the icon stays centered even if panels have different heights */
    align-self: center; 
}

.trade-preview {
    margin-top: 16px;
    padding: 16px;
    background-color: white;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    min-height: 100px;
    color: var(--color-text-muted);
    flex-grow: 1; /* Allow preview to fill space */
}

.trade-preview-details {
    color: var(--color-text);
}

.trade-preview-details h4 {
    margin-top: 0;
    margin-bottom: 12px;
    font-size: 16px;
    font-weight: 600;
}

.trade-preview-details ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
}

.trade-preview-details li {
    font-size: 13px;
    margin-bottom: 4px;
    font-family: monospace; /* Use monospace for time alignment */
}


.trade-actions {
    margin-top: 32px;
    text-align: center;
}


/* === SEQUENTIAL BUILDER MODAL (Shared) === */
.modal-backdrop { display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(17, 24, 39, 0.5); align-items: center; justify-content: center; }
.modal-content { background-color: var(--color-panel-bg); margin: auto; border-radius: var(--border-radius); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); display: flex; flex-direction: column; max-height: 85vh; }
.modal-lg { width: 90%; max-width: 1000px; }
.modal-header, .modal-footer { padding: 20px 24px; }
.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--color-border); }
.modal-footer { border-top: 1px solid var(--color-border); display: flex; justify-content: space-between; align-items: center; }
.modal-close { color: var(--color-text); }
.modal-body { flex-grow: 1; overflow: hidden; padding: 24px; }

/* Layout inside the modal */
.sequential-layout { display: flex; flex-direction: column; height: 100%; }
.builder-controls { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 24px; }
.time-picker-input { width: 120px; }

/* Scrollable grid container */
.builder-grid-container { flex-grow: 1; overflow-y: auto; border-radius: var(--border-radius); }

/* Specific table styles for the builder */
.builder-grid th { font-size: 12px; padding: 10px 16px; position: sticky; top: 0; z-index: 1; }

/* Compact row action buttons in Assignments */
.btn-group {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

/* Inline footer under rotation grid */
.table-footer-inline {
  display: flex;
  justify-content: center;
  padding: 12px 0 4px;
}

/* Compact, flexible action buttons in the last cell */
.actions-cell .btn-group {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

.builder-grid .form-select, .builder-grid .form-input { width: 100%; padding: 6px 10px; font-size: 13px; }
.duration-input { max-width: 100px; }
.time-display { font-weight: 500; color: var(--color-text-muted); }
.editor-summary { font-size: 14px; font-weight: 500; }

/* V15.1: Exception Reason Input */
.exception-reason-group {
    margin-bottom: 24px;
}

#modalExceptionReason {
    width: 100%;
}

/* === NOTIFICATION TOAST === */
#notification-container {
  position: fixed;
  bottom: 24px;
  right: 24px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.toast {
  padding: 16px 20px;
  border-radius: var(--border-radius);
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  min-width: 300px;
  color: var(--color-text);
  font-weight: 500;
}

.toast.is-success {
    background-color: #D1FAE5;
    border-left: 4px solid var(--brand-accent);
}

.toast.is-danger {
    background-color: var(--color-danger-bg);
    border-left: 4px solid var(--color-danger);
}
/* Compact actions cell in Assignments grid */
.table .actions { white-space: nowrap; }
.table .actions .btn { margin-right: 8px; }
.table .actions .btn:last-child { margin-right: 0; }
