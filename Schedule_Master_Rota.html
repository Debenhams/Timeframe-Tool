<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Team Schedule & Rota</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f9f9f9;
        margin: 0;
        padding: 0;
    }
    header {
        background: #0052cc;
        color: white;
        padding: 15px;
        text-align: center;
    }
    .controls {
        display: flex;
        justify-content: space-between;
        padding: 10px 20px;
        background: #eaeaea;
        flex-wrap: wrap;
    }
    .controls select, .controls button {
        padding: 5px 10px;
        margin: 5px;
    }
    table {
        border-collapse: collapse;
        width: 100%;
        margin: 20px auto;
        table-layout: fixed;
    }
    th, td {
        border: 1px solid #ddd;
        text-align: center;
        padding: 10px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    th {
        background: #0052cc;
        color: white;
        position: sticky;
        top: 0;
        z-index: 2;
    }
    .shift {
        padding: 5px;
        border-radius: 5px;
        color: white;
        font-weight: bold;
        font-size: 0.9em;
    }
    .early { background-color: #6c5ce7; }
    .middle { background-color: #00b894; }
    .late { background-color: #fd79a8; }
    .break { background-color: #ffeaa7; color: #2d3436; }
    .lunch { background-color: #fab1a0; color: #2d3436; }
    .email { font-size: 0.8em; margin-top: 3px; display: block; color: #fff; }
    .mirakl { font-size: 0.8em; margin-top: 3px; display: block; color: #fff; }
    .hidden { display: none; }
</style>
</head>
<body>
<header>
    <h1>Team Schedule & Rota</h1>
</header>

<div class="controls">
    <div>
        <label for="userSelect">Select User:</label>
        <select id="userSelect">
            <option value="all">All Team</option>
            <option value="Luke Pashley">Luke Pashley</option>
            <option value="Ameena Malik">Ameena Malik</option>
            <option value="Carrie-Ann Raw">Carrie-Ann Raw</option>
            <option value="Danielle Smith">Danielle Smith</option>
            <option value="Farwa Shaheen">Farwa Shaheen</option>
            <option value="Gemma Emmett">Gemma Emmett</option>
            <option value="Laura Stockburn">Laura Stockburn</option>
            <option value="Millie Walsh">Millie Walsh</option>
            <option value="Tunis Foley">Tunis Foley</option>
        </select>
    </div>
    <div>
        <label for="weekSelect">Select Week:</label>
        <input type="week" id="weekSelect"/>
        <button id="toggleView">Toggle View</button>
        <button id="downloadPDF">Download PDF</button>
    </div>
</div>

<table id="scheduleTable">
    <thead>
        <tr>
            <th>Time</th>
            <th>Luke Pashley</th>
            <th>Ameena Malik</th>
            <th>Carrie-Ann Raw</th>
            <th>Danielle Smith</th>
            <th>Farwa Shaheen</th>
            <th>Gemma Emmett</th>
            <th>Laura Stockburn</th>
            <th>Millie Walsh</th>
            <th>Tunis Foley</th>
        </tr>
    </thead>
    <tbody>
        <!-- Schedule rows dynamically generated here -->
    </tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
    const users = ['Luke Pashley','Ameena Malik','Carrie-Ann Raw','Danielle Smith','Farwa Shaheen','Gemma Emmett','Laura Stockburn','Millie Walsh','Tunis Foley'];
    let viewMode = 'week'; // week/daily toggle
</script>
<script>
const scheduleTableBody = document.querySelector('#scheduleTable tbody');
const userSelect = document.getElementById('userSelect');
const weekSelect = document.getElementById('weekSelect');
const toggleViewBtn = document.getElementById('toggleView');
const downloadPDFBtn = document.getElementById('downloadPDF');

// Sample shift data structure
let shifts = {
    'Luke Pashley': [],
    'Ameena Malik': [],
    'Carrie-Ann Raw': [],
    'Danielle Smith': [],
    'Farwa Shaheen': [],
    'Gemma Emmett': [],
    'Laura Stockburn': [],
    'Millie Walsh': [],
    'Tunis Foley': []
};

// Default times for demonstration (can be customized per shift)
const defaultTimes = ['08:00', '09:00', '10:00', '11:00', '12:00','13:00','14:00','15:00','16:00','17:00'];

function generateSchedule() {
    scheduleTableBody.innerHTML = '';

    // Create row for each time
    defaultTimes.forEach(time => {
        const tr = document.createElement('tr');
        const timeCell = document.createElement('td');
        timeCell.textContent = time;
        tr.appendChild(timeCell);

        users.forEach(user => {
            const td = document.createElement('td');
            td.dataset.user = user;

            // Filter shifts for this time
            const shift = shifts[user].find(s => s.start <= time && s.end > time);
            if (shift) {
                const span = document.createElement('span');
                span.classList.add('shift', shift.type);
                span.textContent = shift.type.charAt(0).toUpperCase() + shift.type.slice(1);
                if(shift.email) {
                    const emailSpan = document.createElement('span');
                    emailSpan.classList.add('email');
                    emailSpan.textContent = 'Email';
                    span.appendChild(emailSpan);
                }
                if(shift.mirakl) {
                    const miraklSpan = document.createElement('span');
                    miraklSpan.classList.add('mirakl');
                    miraklSpan.textContent = 'Mirakl';
                    span.appendChild(miraklSpan);
                }
                td.appendChild(span);
            }

            tr.appendChild(td);
        });

        scheduleTableBody.appendChild(tr);
    });
}

// Toggle daily/weekly view
toggleViewBtn.addEventListener('click', () => {
    viewMode = (viewMode === 'week') ? 'daily' : 'week';
    generateSchedule();
});

// Filter by user
userSelect.addEventListener('change', () => {
    const selectedUser = userSelect.value;
    document.querySelectorAll('#scheduleTable tbody td').forEach(td => {
        if(selectedUser === 'all') {
            td.classList.remove('hidden');
        } else if(td.dataset.user !== selectedUser && td.dataset.user !== undefined) {
            td.classList.add('hidden');
        } else {
            td.classList.remove('hidden');
        }
    });
});

// Week selector change (stub, can integrate real week-based shifts)
weekSelect.addEventListener('change', () => {
    generateSchedule();
});

// Function to add shift manually
function addShift(user, type, start, end, email=false, mirakl=false) {
    if(!shifts[user]) shifts[user] = [];
    shifts[user].push({type, start, end, email, mirakl});
    generateSchedule();
}

// Example: Adding sample shifts
addShift('Luke Pashley','early','08:00','12:00',true,false);
addShift('Luke Pashley','middle','13:00','17:00',false,true);
addShift('Ameena Malik','late','10:00','18:00',false,true);

// PDF Download
downloadPDFBtn.addEventListener('click', () => {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF('l', 'pt', 'a4');
    doc.html(document.querySelector('#scheduleTable'), {
        callback: function(pdf) {
            pdf.save('team_schedule.pdf');
        },
        x: 10,
        y: 10,
        html2canvas: { scale: 0.8 }
    });
});

// Initial render
generateSchedule();
</script>
<script>
function createCustomShiftUI() {
    const controlsDiv = document.createElement('div');
    controlsDiv.style.background = '#f1f1f1';
    controlsDiv.style.padding = '10px';
    controlsDiv.style.margin = '10px 20px';
    controlsDiv.style.borderRadius = '8px';

    controlsDiv.innerHTML = `
        <h3>Custom Shift Management</h3>
        <label>User: <select id="customUser">
            ${users.map(u=>`<option value="${u}">${u}</option>`).join('')}
        </select></label>
        <label>Shift Type: <input type="text" id="customType" placeholder="Early/Middle/Late/Custom"></label>
        <label>Start Time: <input type="time" id="customStart"></label>
        <label>End Time: <input type="time" id="customEnd"></label>
        <label>Break (min): <input type="number" id="customBreak" value="0"></label>
        <label>Lunch (min): <input type="number" id="customLunch" value="0"></label>
        <label>Email Task: <input type="checkbox" id="customEmail"></label>
        <label>Mirakl Task: <input type="checkbox" id="customMirakl"></label>
        <button id="addCustomShift">Add Shift</button>
    `;
    document.body.insertBefore(controlsDiv, document.getElementById('scheduleTable'));

    document.getElementById('addCustomShift').addEventListener('click', () => {
        const user = document.getElementById('customUser').value;
        const type = document.getElementById('customType').value.toLowerCase();
        const start = document.getElementById('customStart').value;
        const end = document.getElementById('customEnd').value;
        const email = document.getElementById('customEmail').checked;
        const mirakl = document.getElementById('customMirakl').checked;

        addShift(user, type, start, end, email, mirakl);
    });
}

// Initialize custom shift UI
createCustomShiftUI();
</script>
</body>
</html>


