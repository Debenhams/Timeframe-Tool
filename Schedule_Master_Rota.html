<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Professional Team Rota System â€” Supabase</title>

  <!-- Your planner styles -->
  <link rel="stylesheet" href="./styles/planner.css?v=1" />

  <!-- (Optional) Any page-specific styles you already had can remain here -->
</head>
<body>
  <!--
    Keep your existing page structure exactly as-is:
    - weekStart (id=weekStart), teamDay (id=teamDay), rotation select (id=rotationName)
    - advisor tree (id=advisorTree or #tree), planner header/body (id=timeHeader, id=plannerBody)
    - assignment table (id=assignTable), etc.
  -->

  <!-- Supabase client init (use YOUR values; keep your existing block) -->
  <script>
    const _SUPABASE_URL  = "<YOUR_SUPABASE_URL>";
    const _SUPABASE_ANON = "<YOUR_SUPABASE_ANON_KEY>";

    // Create a single shared client and expose as window.supabase
    if (!window.supabase || typeof window.supabase.from !== "function") {
      if (window.supabase && typeof window.supabase.createClient === "function") {
        window.supabase = window.supabase.createClient(_SUPABASE_URL, _SUPABASE_ANON);
      } else if (window.Supabase && typeof window.Supabase.createClient === "function") {
        window.supabase = window.Supabase.createClient(_SUPABASE_URL, _SUPABASE_ANON);
      }
    }
    console.log("supabase client ready:", typeof window.supabase?.from);
  </script>

  <!-- Project scripts (load planner first, then the wiring/init) -->
  <script src="./src/planner.js?v=1"></script>
  <script src="./src/init.js?v=1"></script>

  <!-- Light boot so dropdowns fill and the planner paints on load -->
  <script>
    (function () {
      async function onReady() {
        try {
          await (globalThis.bootAdvisors?.() || Promise.resolve());
          await (globalThis.bootRotations?.() || Promise.resolve());
          globalThis.populateRotationSelect?.();
          globalThis.refreshPlannerUI?.();
        } catch (e) {
          console.warn('initial boot failed', e);
        }
      }
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', onReady, { once: true });
      } else {
        onReady();
      }
    })();
  </script>
</body>
</html>
