<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Professional Team Rota System â€” Supabase</title>
<style>
  :root{
    --brand:#0d47a1; --accent:#00c853; --ink:#1f2937; --paper:#ffffff; --wash:#f5f7fb; --line:#e4e9f2;
    --timeline-start:7; --timeline-end:20; --timeline-height:800px;
    --color-email:#2ecc71; --color-mirakl:#b1b51e; --color-social:#5e35b1;
    --color-overtime:#e53935; --color-meeting:#ffd700; --color-break:#cfd8dc; --color-lunch:#b0bec5;
    --color-absence:#b0c4de; --color-shrink:#ffd166;

    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 12px;
    --spacing-lg: 16px;
    --card-bg: #ffffff;
    --card-border: #e5e7eb;
    --card-radius: 8px;
    --table-hover: #f8fafc;
    --table-stripe: #f9fafb;
  }
  html,body{height:100%}
  body{margin:0;background:#eef2f6;color:var(--ink);font-family:Inter,Roboto,Segoe UI,system-ui,Arial,Helvetica,sans-serif}
  .topbar{background:var(--brand);color:#fff;padding:14px 18px;display:flex;align-items:center;gap:14px;box-shadow:0 4px 14px rgba(13,71,161,.18)}
  .topbar h1{margin:0;font-size:18px;font-weight:800}
  .layout{display:grid;grid-template-columns:1fr 360px;gap:18px;max-width:1500px;margin:18px auto;padding:0 16px}
  .panel{background:var(--paper);border:1px solid var(--line);border-radius:12px;box-shadow:0 8px 20px rgba(12,27,74,.06)}
  .panel-header{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--line)}
  .panel-header h2{margin:0;font-size:15px}
  .panel-body{padding:12px 14px}
  .muted{color:#64748b}
  .btn{background:var(--accent);color:#fff;border:0;border-radius:10px;padding:9px 12px;font-weight:800;cursor:pointer}
  .btn:hover{filter:brightness(.95)}
  .btn.subtle{background:#e9eef6;color:#0f172a}
  .btn.icon{padding:7px 9px}
  .seg{display:inline-flex;border:1px solid var(--line);border-radius:10px;overflow:hidden}
  .seg button{background:#fff;border:0;padding:8px 12px;cursor:pointer}
  .seg button.active{background:#1e5fe0;color:#fff}
  .input, select, input[type=date]{padding:8px 10px;border:1px solid var(--line);border-radius:10px;background:#fff}
  .collapsible[open] .chev{transform:rotate(90deg)} .chev{transition:transform .2s}

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */

  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .danger{background:#dc3545;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer}

  .key-row{display:grid;grid-template-columns:18px 120px 1fr;gap:8px;align-items:center;margin-bottom:8px}
  .swatch{width:18px;height:18px;border-radius:3px;border:1px solid var(--line)}

  .table-wrap{overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:900px}
  th,td{border:1px solid var(--line);padding:8px;text-align:center}
  thead th{background:#0d47a1;color:#fff;font-weight:800}
  td.name{position:sticky;left:0;background:#e8f1ff;font-weight:800}

  /* Calendar */
  .calendar{border-top:1px solid var(--line)}
  .cal-grid{display:grid;grid-template-columns:80px repeat(7,1fr);grid-auto-flow:column;overflow:auto}
  .hour-col{border-right:1px solid var(--line);background:#fafcfe}
  .hour{height:calc(var(--timeline-height)/(var(--timeline-end)-var(--timeline-start)));border-bottom:1px solid var(--line);font-size:12px;color:#748099;text-align:right;padding-right:6px;position:relative;box-sizing:border-box}
  .hour span{position:absolute;top:-7px;right:6px;background:#fafcfe;padding:0 4px}

  .day-col{border-left:1px solid var(--line)}
  .day-head{height:56px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;justify-content:center;padding:6px 10px;background:#f6f8fb;font-weight:800}
  .day-head small{font-weight:700;color:#8792a6}
  .day-summary{display:flex;align-items:center;gap:8px;padding:6px 10px;border-bottom:1px solid var(--line)}
  .summary-right{margin-left:auto;color:#5b6b7f;font-size:12px}
  .day-actions{display:flex;gap:6px;border-bottom:1px solid var(--line);padding:6px 10px}
  .iconbtn{border:1px solid var(--line);background:#fff;border-radius:6px;padding:6px 8px;cursor:pointer}
  .off{height:40px;border-bottom:1px solid var(--line);padding:8px 10px;background:repeating-linear-gradient(45deg,#f2f3f7,#f2f3f7);font-weight:800;color:#8892a0}
  .timeline-cell{position:relative;height:var(--timeline-height);background:
    linear-gradient(#0000,#0000),
    repeating-linear-gradient(180deg,#0000,#0000 calc(100%/(var(--timeline-end) - var(--timeline-start))), var(--line) 0, var(--line) calc(100%/(var(--timeline-end) - var(--timeline-start)) + 1px));}
  .block{position:absolute;left:10px;right:10px;border-radius:6px;padding:3px 6px;font-size:11px;font-weight:800;color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12);line-height:1.1;cursor:pointer;display:flex;justify-content:space-between;gap:6px;align-items:flex-start}
  .block .time{display:block;font-weight:700;font-size:10px;opacity:.95}

  .c-email{background:var(--color-email)}
  .c-mirakl{background:var(--color-mirakl)}
  .c-social{background:var(--color-social)}
  .c-break{background:var(--color-break);color:#213}
  .c-lunch{background:var(--color-lunch);color:#213}
  .c-overtime{background:var(--color-overtime)}
  .c-absence{background:var(--color-absence)}
  .c-shrink{background:var(--color-shrink);color:#213}

  @media print{.no-print{display:none} .panel{box-shadow:none}}

  /* Dialogs */
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .row .del{background:#ffe2e2;color:#b42318;border:1px solid #f2b8b5;border-radius:6px;padding:4px 8px;cursor:pointer}
  dialog{max-width:780px;width:95%}

  /* Schedules tree (right sidebar) */
  .tree-search{display:flex;gap:8px;margin-bottom:8px}
  .tree{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  .tree details{padding:3px 4px;border-radius:6px}
  .tree summary{list-style:none;cursor:pointer;font-weight:800;display:flex;align-items:center;gap:6px}
  .tree summary .twisty{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--line);border-radius:4px;background:#f5f7fb;font-weight:900}
  .tree summary::-webkit-details-marker{display:none}
  .tree .node{display:flex;gap:6px;align-items:center;padding:2px 2px}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #d6dcff;border-radius:999px;padding:3px 8px;font-size:12px}
  .node-actions button{border:1px solid var(--line);background:#fff;border-radius:6px;padding:3px 6px;cursor:pointer;font-size:11px}

  /* Utility classes */
  .grid-templates {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }

  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--spacing-md);
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .card-header {
    margin-bottom: var(--spacing-md);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-footer {
    margin-top: var(--spacing-md);
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
  }

  .btn {
    border: 0;
    border-radius: 6px;
    padding: 8px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-secondary {
    background: #f3f4f6;
    color: #374151;
  }

  .btn-danger {
    background: #fee2e2;
    color: #b91c1c;
  }

  /* Hide colour palette */
  .is-hidden {
    display: none;
  }

  /* Enhanced table styles */
  .rota-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--card-border);
  }

  .rota-table thead {
    position: sticky;
    top: 0;
    background: white;
    z-index: 2;
  }

  .rota-table th {
    padding: var(--spacing-sm);
    border-bottom: 2px solid var(--card-border);
    font-weight: 600;
    text-align: left;
  }

  .rota-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--card-border);
  }

  .rota-table tr:nth-child(even) {
    background: var(--table-stripe);
  }

  .rota-table tr:hover {
    background: var(--table-hover);
  }

  .rota-table td:first-child {
    position: sticky;
    left: 0;
    background: inherit;
    font-weight: 500;
    z-index: 1;
  }

  .rota-table select {
    width: 100%;
    height: 32px;
    padding: 0 var(--spacing-sm);
    border: 1px solid var(--card-border);
    border-radius: 4px;
    background: white;
  }

  /* Empty state */
  .empty-state {
    padding: var(--spacing-lg);
    text-align: center;
    color: #6b7280;
    border: 1px dashed var(--card-border);
    border-radius: var(--card-radius);
  }

  /* Template editor */
  .template-row{display:grid;grid-template-columns:140px 1fr 140px 1fr;gap:10px 14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fafcff;margin-bottom:10px}
  .template-row .full{grid-column:1/-1}
  .inline{display:flex;gap:8px;flex-wrap:wrap}